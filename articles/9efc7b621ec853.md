---
title: "Zigã¯CMakeã®ä»£æ›¿ã¨ãªã‚‹ã‹"
emoji: "ğŸ”¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["zig", "cmake", "cpp", "c"]
published: true
---

# ã¯ã˜ã‚ã«

å¼•ãç¶šã[Zig](https://ziglang.org/)ã‚’è§¦ã£ã¦ã„ã‚‹ã€‚
https://zenn.dev/ryoppippi/articles/4fc7570643339d
https://github.com/ryoppippi/nyancat.zig

ä»Šå›ã¯C/C++ toolchainã¨ã—ã¦ã®Zigã«ã¤ã„ã¦æ›¸ã„ã¦ã„ãã€‚

# Zig as a C/C++ Toolchain
ã¾ãšã€Zigã¯Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§ã‚‚ã‚ã‚‹ã€‚
ã“ã‚ŒãŒä½•ã‚’æ„å‘³ã™ã‚‹ã‹ã¨ã„ãˆã°

- Zigãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§C/C++ã‚’åˆ©ç”¨ã§ãã‚‹
- C/C++ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Zigã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹

ã¨ã„ã†ã‚ã‘ã§ã€C/C++ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«Zigã‚’å°å…¥ã™ã‚‹ã¨å¬‰ã—ã„ã“ã¨ã‚’åˆ—æŒ™ã—ã¦ã„ãã€‚

## ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã‹ã¤ä½•ã§ã‚‚å±‹ã®Toolchain
Zig Toolchainã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã€ãƒªãƒ³ã‚«ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å«ã‚“ã§ã„ã‚‹ã€‚
ã¾ãŸã€æ¨™æº–ã§ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«ã‚‚å¯¾å¿œã—ã¦ã„ã‚‹ã€‚
ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ãŒå…¨éƒ¨å«ã¾ã‚Œã¦ã„ã‚‹ã®ã«ã‚‚é–¢ã‚ã‚‰ãšã€å®¹é‡ãªã‚“ã¨40MBã»ã©ã€‚ã¨ã¦ã‚‚å°ã•ã„ã€‚
ã“ã®ã‚ˆã†ã«ã€Zig toolchainã¯ãƒ“ãƒ«ãƒ‰ç’°å¢ƒã¨ã—ã¦ã¯æ¥µã‚ã¦å°å…¥ãŒç°¡å˜ã§ã‚ã‚‹ã¨è¨€ãˆã‚‹ã€‚

## gcc/clangã‚³ãƒãƒ³ãƒ‰ã‚’ç½®ãæ›ãˆã¦ã¿ã‚‹
```sh
â¯ gcc main.c -o main
â¯ zig cc main.c -o main
â¯ ./main
Hello world
```
æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ç½®ãæ›ãˆã‚‹ã ã‘ã§ã€Zigã«ä»˜å±ã—ã¦ã„ã‚‹Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’åˆ©ç”¨ã§ãã‚‹ã€‚


## ã‚¯ãƒ­ã‚¹ãƒ“ãƒ«ãƒ‰ãŒæ¨™æº–ã§å¯èƒ½
ä¸Šã§ã‚‚è¿°ã¹ãŸé€šã‚Šã€Zigã¯æ¨™æº–ã§ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒå¯èƒ½ã§ã‚ã‚‹ã€‚

::: details Zig libcã®Targetä¸€è¦§
```sh
â¯ zig targets | jq ".libc"
[
  "aarch64_be-linux-gnu",
  "aarch64_be-linux-musl",
  "aarch64_be-windows-gnu",
  "aarch64-linux-gnu",
  "aarch64-linux-musl",
  "aarch64-windows-gnu",
  "aarch64-macos-none",
  "aarch64-macos-none",
  "armeb-linux-gnueabi",
  "armeb-linux-gnueabihf",
  "armeb-linux-musleabi",
  "armeb-linux-musleabihf",
  "armeb-windows-gnu",
  "arm-linux-gnueabi",
  "arm-linux-gnueabihf",
  "arm-linux-musleabi",
  "arm-linux-musleabihf",
  "thumb-linux-gnueabi",
  "thumb-linux-gnueabihf",
  "thumb-linux-musleabi",
  "thumb-linux-musleabihf",
  "arm-windows-gnu",
  "csky-linux-gnueabi",
  "csky-linux-gnueabihf",
  "i386-linux-gnu",
  "i386-linux-musl",
  "i386-windows-gnu",
  "m68k-linux-gnu",
  "m68k-linux-musl",
  "mips64el-linux-gnuabi64",
  "mips64el-linux-gnuabin32",
  "mips64el-linux-musl",
  "mips64-linux-gnuabi64",
  "mips64-linux-gnuabin32",
  "mips64-linux-musl",
  "mipsel-linux-gnueabi",
  "mipsel-linux-gnueabihf",
  "mipsel-linux-musl",
  "mips-linux-gnueabi",
  "mips-linux-gnueabihf",
  "mips-linux-musl",
  "powerpc64le-linux-gnu",
  "powerpc64le-linux-musl",
  "powerpc64-linux-gnu",
  "powerpc64-linux-musl",
  "powerpc-linux-gnueabi",
  "powerpc-linux-gnueabihf",
  "powerpc-linux-musl",
  "riscv64-linux-gnu",
  "riscv64-linux-musl",
  "s390x-linux-gnu",
  "s390x-linux-musl",
  "sparc-linux-gnu",
  "sparc64-linux-gnu",
  "wasm32-freestanding-musl",
  "wasm32-wasi-musl",
  "x86_64-linux-gnu",
  "x86_64-linux-gnux32",
  "x86_64-linux-musl",
  "x86_64-windows-gnu",
  "x86_64-macos-none",
  "x86_64-macos-none",
  "x86_64-macos-none"
]
```
:::

Cè¨€èªã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã¨ãã«ã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ç”Ÿæˆã™ã‚‹ãƒã‚¤ãƒŠãƒªã‚’æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹libcã¨ãƒªãƒ³ã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
Zig toolchainã«ã¯è¤‡æ•°ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®libcãŒå«ã¾ã‚Œã¦ã„ã¦ã€ç”Ÿæˆã™ã‚‹ãƒã‚¤ãƒŠãƒªã«ãã‚Œã‚‰ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã‚‹ãŸã‚ï¼ˆé™çš„ãƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹ãŸã‚ï¼‰ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå…ˆã§ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã™ã‚‹å¿…è¦ãŒãªã„ã€‚
ã¨ã¦ã‚‚ãƒãƒ¼ã‚¿ãƒ–ãƒ«ã‹ã¤ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãªãƒã‚¤ãƒŠãƒªã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```sh
â¯ zig cc main.c -o main --target=aarch64-linux-musl
â¯ docker run -it --rm -v $(pwd):/data -w /data alpine:3.16 ./main
Hello world
```

å…ˆã«è¿°ã¹ãŸé€šã‚Šã€C/C++ã‚’ä½¿ã†ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ã©ã“ã‹ã§ä½¿ã£ã¦ã„ã‚‹ã¯ãšãªã®ã§ã€æ—¢å­˜ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ç½®ãæ›ãˆã‚‹ã ã‘ã§ã‚¯ãƒ­ã‚¹ãƒ“ãƒ«ãƒ‰ãŒå¯èƒ½ãªã®ã¯ã¨ã¦ã‚‚ä¾¿åˆ©ã€‚

## ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ãŒå„ªç§€
Zigã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ä¸€åº¦ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã¨ã€ãã®çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ã™ã‚‹ã€‚
ãã®ãŸã‚ã€2å›ç›®ä»¥é™ã®ãƒ“ãƒ«ãƒ‰ã¯é«˜é€ŸåŒ–ã•ã‚Œã‚‹ã€‚


## ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚’ç½®ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ï¼Ÿ
ã•ã¦ã€ã‚ˆã‚Šä¾å­˜é–¢ä¿‚ã®å¤šã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã‚ˆã†ã€‚
ç¾ä»£ã®æ¨™æº–çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯`make`ã‚„`CMake`ã€`bazel`ã¨ã„ã£ãŸãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒã‚ˆãç”¨ã„ã‚‰ã‚Œã‚‹ã€‚
ã“ã“ã§ã¯ç­†è€…ãŒæ™®æ®µã‚ˆãè§¦ã‚Œã¦ã„ã‚‹`CMake`ã¨æ¯”è¼ƒã™ã‚‹ã€‚

æ¯”è¼ƒã®ãŸã‚ã«ã€[Egien](https://eigen.tuxfamily.org/index.php?title=Main_Page)ã¨[Spectra](https://spectralib.org)ã‚’ç”¨ã„ãŸç°¡å˜ãªC++ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ãŸã€‚

https://github.com/ryoppippi/cpp-zig-build-system-demo/tree/9820e84775f0d11da81999712b88f4e5522cd371

### CMake
ç¾ä»£ã®`CMake`ã¯ã•ã¾ã–ã¾ãªã‚³ãƒãƒ³ãƒ‰ã‚’`CMakeLists.txt`ã«è¨˜è¿°ã™ã‚‹ã“ã¨ã§ä¾å­˜ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
ã¾ãŸã€`find_package`ã‚„`ExternalProject_Add`,`execute_process`ã‚’é§†ä½¿ã™ã‚‹ã“ã¨ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¢ã—ãŸã‚Šå¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
C/C++ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯å¿…é ˆã®ãƒ„ãƒ¼ãƒ«ã¨è¨€ã£ã¦è‰¯ã„ã ã‚ã†ã€‚

ãŸã ã—ã„ãã¤ã‹å•é¡Œã¯ã‚ã‚‹ã€‚
ä¾‹ãˆã°ã€`CMakeLists.txt`ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹éƒ½åˆä¸Šã€å°å›ã‚ŠãŒåˆ©ã‹ãªã‹ã£ãŸã‚Šç‹¬è‡ªã®è¨˜æ³•ã€å¾¡ä½œæ³•ã«æˆ¸æƒ‘ã†ã“ã¨ã‚‚å¤šã„ã€‚
ã¾ãŸãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Œé‚ã™ã‚‹ãŸã‚ã«ã¯`CMake`ã ã‘ã§ã¯ãªãã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’åˆ¥é€”å°å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã¯ã‚‚ã¡ã‚ã‚“ã€`Make`ã‚„`Ninja`ç­‰ã®ãƒ„ãƒ¼ãƒ«ã€å ´åˆã«ã‚ˆã£ã¦ã¯ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã©è¤‡æ•°ã®ãƒ„ãƒ¼ãƒ«ã‚’é§†ä½¿ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„^[CMakeLists.txtã‚„Makefileã€Configure.shãªã©ã„ãã¤ã‚‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã¿ãŸã“ã¨ãŒã‚ã‚‹ã¯ãšã§ã‚ã‚‹]ã€‚


```cmake:CMakeLists.txt
cmake_minimum_required(VERSION 3.5)
include(ExternalProject)
enable_language(Fortran)
set(CMAKE_CXX_STANDARD 14)

set(PROJECT_ROOT "${CMAKE_CURRENT_LIST_DIR}")

find_package(Git QUIET)
if(GIT_FOUND AND EXISTS "${PROJECT_ROOT}/.git")
  execute_process(COMMAND ${GIT_EXECUTABLE} submodule update --init --recursive
    WORKING_DIRECTORY ${PROJECT_ROOT}
    RESULT_VARIABLE GIT_SUBMOD_RESULT)
  if(NOT GIT_SUBMOD_RESULT EQUAL "0")
    message(FATAL_ERROR "git submodule update --init --recursive failed with ${GIT_SUBMOD_RESULT}, please checkout submodules")
  endif()
endif()

if(APPLE)
   set(CMAKE_CXX_FLAGS "${CMAKE_C_FLAGS} -framework Accelerate")
endif()

message(${CMAKE_HOST_SYSTEM_NAME})
message(${CMAKE_SOURCE_DIR})
message("${cmake_current_source_dir}")

find_package(BLAS)
if(BLAS_FOUND)
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -I${BLAS_INCLUDE_DIR} -DEIGEN_USE_BLAS")
endif()

set(third_PARTY_DIR "${PROJECT_ROOT}/third_party")
set(EIGEN3_INCLUDE_DIRS "${third_PARTY_DIR}/eigen")
set(SPECTRA_INCLUDE_DIRS "${third_PARTY_DIR}/spectra/include")

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DEIGEN_FAST_MATH=1 -DEIGEN_NO_DEBUG -DTHREAD_SAFE")

project(sample CXX )
add_executable(main ${PROJECT_ROOT}/src/main.cpp)
target_include_directories(main
  PUBLIC
  ${EIGEN3_INCLUDE_DIRS}
  ${SPECTRA_INCLUDE_DIRS}
  )
target_link_libraries(main m blas ${BLAS_LIBRARIES})
message("${CMAKE_CXX_FLAGS}")
```

```sh
mkdir build
cd build
cmake ..
make
./build/main
```
### build.zig
Zigã§ã¯ãƒ“ãƒ«ãƒ‰ã®è¨­å®šã‚’`build.zig`ã«æ›¸ãã“ã¨ãŒã§ãã‚‹ã€‚
`build.zig`ã§ã¯Zigã ã‘ã§ãªãã€C/C++ã®ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’è¨˜è¿°ã§ãã‚‹ã€‚
ä¸­èº«ã¯Zigã®ã‚³ãƒ¼ãƒ‰ãªã®ã§ã€é–¢æ•°ã‚’ç”¨ã„ã¦æ“ä½œã‚’åˆ†å‰²ã—ãŸã‚Šã€å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚„æ¡ä»¶åˆ†å²ã‚’è¨˜è¿°ã™ã‚‹ã“ã¨ã§èª­ã¿ã‚„ã™ãè¨˜è¿°ã—ã‚„ã™ã„ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºæ¥ä¸ŠãŒã‚‹ï¼ˆå€‹äººã®æ„Ÿæƒ³ï¼‰ã€‚
ã¾ãŸã€å®Ÿè¡Œã‚‚1ã¤ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã§æ¸ˆã‚€ã€‚
ã•ã‚‰ã«ã€ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚å¯èƒ½ã§ã‚ã‚‹ã€‚
ãŸã ã—ã€CMakeã®`find_package`ã«ç›¸å½“ã™ã‚‹æ©Ÿèƒ½ãŒæœªå®Ÿè£…ãªãŸã‚ã€å…¨ã¦ã‚’ç½®ãæ›ãˆã‚‹ã“ã¨ã¯ã§ããªã‹ã£ãŸ(BLASãªã©ã®å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒªãƒ³ã‚¯ã‚’ã™ã‚‹ã“ã¨ã¯ã‚‚ã¡ã‚ã‚“ã§ãã‚‹ã‚‚ã®ã®ã€ãƒªãƒ³ã‚¯ã§ããªã‹ã£ãŸå ´åˆã¯å˜ã«ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã™ã‚‹ã ã‘ã§ã‚ã‚‹)ã€‚â†’ [è¿½è¨˜](#è¿½è¨˜)å‚ç…§

```zig:build.zig
const std = @import("std");
const Builder = std.build.Builder;

pub fn build(b: *Builder) void {
    const target = b.standardTargetOptions(.{});
    const mode = b.standardReleaseOptions();

    ensureSubmodules(b.allocator) catch |err| @panic(@errorName(err));

    const exe = b.addExecutable("main", null);
    exe.setTarget(target);
    exe.setBuildMode(mode);

    exe.addCSourceFile("src/main.cpp", &[_][]const u8{});
    exe.addIncludeDir("third_party/eigen");
    exe.addIncludeDir("third_party/spectra/include");

    exe.defineCMacro("EIGEN_FAST_MATH", "1");
    exe.defineCMacro("THREAD_SAFE", "");
    exe.linkSystemLibrary("m");

    if (target.isNative()) {
        exe.defineCMacro("EIGEN_USE_BLAS", "");
        exe.linkSystemLibrary("blas");
        if (target.isDarwin()) {
            exe.linkFramework("Accelerate");
        }
    }

    if (b.is_release) {
        exe.defineCMacro("EIGEN_NO_DEBUG", "");
    }

    exe.linkLibCpp();
    exe.install();

    const run_cmd = exe.run();
    run_cmd.step.dependOn(b.getInstallStep());
    if (b.args) |args| {
        run_cmd.addArgs(args);
    }
    const run_step = b.step("run", "Run the app");
    run_step.dependOn(&run_cmd.step);
}

fn ensureSubmodules(allocator: std.mem.Allocator) !void {
    if (std.process.getEnvVarOwned(allocator, "NO_ENSURE_SUBMODULES")) |no_ensure_submodules| {
        if (std.mem.eql(u8, no_ensure_submodules, "true")) return;
    } else |_| {}
    var child = std.ChildProcess.init(&.{ "git", "submodule", "update", "--init", "--recursive" }, allocator);
    child.cwd = (comptime thisDir());
    child.stderr = std.io.getStdErr();
    child.stdout = std.io.getStdOut();
    _ = try child.spawnAndWait();
}

fn thisDir() []const u8 {
    return std.fs.path.dirname(@src().file) orelse ".";
}
```

```sh
zig build run
```

## Zigã¨ã®é€£æº
ã“ã®è¨˜äº‹ã§ã¯è§¦ã‚Œãªã„ãŒã€ã“ã“ã¾ã§æ¥ã‚Œã°æ—¢å­˜ã®C/C++ã®ã‚³ãƒ¼ãƒ‰ã‚’Zigã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‘¼ã³å‡ºã™ã“ã¨ã€ã‚ã‚‹ã„ã¯ãã®é€†ã‚‚ç°¡å˜ã«ã§ãã‚‹ã€‚
ã¾ãŸZigâ†â†’Cã®ãƒˆãƒ©ãƒ³ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚‚å®¹æ˜“ã§ã‚ã‚‹ã€‚
è©³ã—ãã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ã»ã—ã„ã€‚

https://ziglang.org/ja/learn/overview/#cè¨€èªã‚³ãƒ¼ãƒ‰ã«ä¾å­˜ã™ã‚‹é–¢æ•°å¤‰æ•°å‹ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

# å®Ÿç”¨ä¾‹
å®Ÿéš›Uberã§ã¯Zigã‚’C/C++ toolchainã¨ã—ã¦ä½¿ã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚
CGOã‚’ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ç’°å¢ƒã¨ã—ã¦åˆ©ç”¨ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã‚ã‚‹ã€‚
(Zigè¨€èªè‡ªä½“ã¯ã¾ã åˆ©ç”¨ã—ã¦ã„ãªã„ã¨ã®ã“ã¨)
https://jakstys.lt/2022/how-uber-uses-zig/

ã¾ãŸDenoã®æ‹¡å¼µã‚’ã‚¯ãƒ­ã‚¹ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã®ã«Zig CCã‚’ä½¿ã£ãŸä¾‹ã‚‚ã‚ã‚‹ã€‚
https://github.com/mattn/deno-expandhome/blob/main/.github/workflows/release.yaml#L9-L29

https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html


# å€‹äººçš„æ‰€æ„Ÿ
- Zigã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã«C/C++ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã€ã•ã¾ã–ã¾ãªæ©æµã‚’å¾—ã‚‰ã‚Œã‚‹äºˆæ„ŸãŒã™ã‚‹ã€‚
- å€‹äººçš„ã«ã¯è¨­å®šãŒæ›¸ãã‚„ã™ãæ„Ÿã˜ãŸã€‚å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯CMakeã‚’ç½®ãæ›ãˆã¦ã„ãã‹ã‚‚ã—ã‚Œãªã„ã€‚
- ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ä¾¿åˆ©ã€‚ä¾‹ãˆã°ãƒ©ã‚ºãƒ‘ã‚¤ç”¨ã®ãƒ“ãƒ«ãƒ‰ã‚’qemuã‚’çµŒç”±ã—ãªã„ã§æ¯è‰¦ã§è¡Œã†ã“ã¨ãŒã§ãã‚‹ã®ã¯ã¨ã¦ã‚‚è‰¯ã„ã€‚
- OpenMPã‚„BLASç­‰ã®libcã«å«ã¾ã‚Œãªã„ã‹ã¤OSã‚„ãƒãƒ¼ãƒ‰ã«å¼·ãä¾å­˜ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨ç›¸æ€§ãŒæ‚ªã„ã€‚ä»Šå¾Œã«æœŸå¾…ï¼ˆè¿½è¨˜:ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ“ãƒ«ãƒ‰ã¯å¤§ä¸ˆå¤«ãã†ï¼‰ã€‚

# è¿½è¨˜
ä»¥å‰ã“ã®è¨˜äº‹ã‚’æ›¸ã„ãŸæ™‚ã«ã€`find_package`ãŒå‹•ã‹ãªã„ã¨åˆ¤æ–­ã—ãŸç†ç”±ã¯ã€OpenMPãŒã†ã¾ããƒªãƒ³ã‚¯ã§ããªã‹ã£ãŸãŸã‚ã§ã‚ã‚‹ã€‚
ã—ã‹ã—ã€ã“ã‚Œã¯includeãƒ‘ã‚¹ãŒé€šã£ã¦ã„ãªã‹ã£ãŸã›ã„ã§ã‚ã‚Šã€ãã¡ã‚“ã¨ãƒ‘ã‚¹ã‚’é€šã›ã°ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ããŸã€‚
ãŸã ä¾ç„¶ã¨ã—ã¦ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã«ä½•ã‹æ¡ä»¶åˆ†å²ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã¯ç¾æ™‚ç‚¹ã§ã¯ã§ããªãã†ã§ã‚ã‚‹ã€‚

https://github.com/ryoppippi/cpp-zig-build-system-demo/compare/9820e84775f0d11da81999712b88f4e5522cd371...0b9b19eb35d175f3a7d31f05a051c9127bff1d51#diff-f87bb3596894756629bc39d595fb18d479dc4edf168d93a911cadcb060f10fcc
